{% extends "base.html" %} 
{% block content %}  
<div class="content-wrapper">
  <section class="content-header">
    <div class="container-fluid">
      <div class="row mb-2">
        <div class="col-sm-6">
          <h1>Aggiungi extra</h1>
        </div>
      </div>
    </div><!-- /.container-fluid -->
  </section><!-- Main content -->

  <section class="content">
   
    <div class="container-fluid">
      
        <!-- left column -->
        <div class="col-xl-12">
         
       <form method="POST"  action="{% url 'aggiungi_extra'%}" name="aggiungi_extra">
      {% csrf_token %}
          <div class="card card-warning">
            <div class="card-header">
              <h3 class="card-title">Aggiungi extra</h3>
            </div><!-- /.card-header -->
         <div class="card-body">
                <div class="row">
                  <div class="col-sm-2">
                    <!-- text input -->
                    <div class="form-group">
                      <label for="nomeofferta">Nome Offerta</label> 
                      {{ formextra.nome}}
                    </div>
                  </div>
                   <div class="col-sm-6">
                    <!-- textarea -->
                    <div class="form-group">
                      <label for="descrizione">Dettagli offerta</label> 
                      {{ formextra.descrizione}}
                    </div>
                  </div>
                  <div class="col-sm-1">
                    <div class="form-group">
                      <label for="prezzo">Prezzo</label> 
                       {{ formextra.prezzo}}
                    </div>
                  </div>
                  <div class="col-sm-1">
                    <!-- text input -->
                    <div class="form-group">
                      <label for="iva">iva</label> 

                      {{ formextra.iva}}
                    </div>
                  </div>
                  <div class="form-group">
                      <label for="totaleivato1">Totale ivato</label> 

                      <input id="totaleivato1" type="text" class="form-control"  disabled name="totaleivato1">
                       {{ formextra.totaleivato}}
                    </div>
                  </div>
                  <div class="col-sm-2">
              <label>Salva</label> 
              <br>

               <input type="submit" value='Submit' name="submit" placeholder="salva" class="btn btn-success"/>
             
            </div>
               <div class="row">
                  <div class="col-sm-10">
                    <br>
                    <br>
                    <h6><strong><bold><italic><font color="#fe5000">Attenzione:</font></h6></strong></bold></italic>
                    <br>
                   <h6><strong><bold><italic>Tutti i campi eccetto la descrizione sono obbligatori.Nel campo iva devi inserire soltanto il valore dell'aliquota iva senza altre aggiunte (esempio: iva 22% devi inserire solo 22 oppure iva 5% devi inserire 5) </h6></strong></bold></italic>
                 </div>
                </div>
			  </div>
            <!-- /.card-body -->
          </div>
         
          	</form>
          </div>
         <!-- /.card-body -->
          </div><!-- /.card -->
      <!--/.col (right) -->

  </section>
</div>




<script type="text/javascript">
$(function() {
  // Handler for .ready() called.
  $("#iva").keyup(function () {
        updatePrice();
    });
    $("#prezzo" ).keyup(function () {
        updatePrice();
    });
});


function updatePrice(){
    var prezzo = parseFloat($('#prezzo').val());
    var iva = parseFloat($('#iva').val());
    var xd=(prezzo*iva)/100;
    var total=prezzo+xd;
    $("#totaleivato").val(total);
    $("#totaleivato1").val(total);
}
</script>

<script type="text/javascript">
  $('#aggiungi_extra').submit(function(event){
        event.preventDefault();
        var $prodotto = $(this);
        $.ajax({
        type: 'post',
        url: "{% url 'aggiungi_extra'%}",
        data:{csrfmiddlewaretoken:$('input[name=csrfmiddlewaretoken]').val(), 
          data:$prodotto.serialize()},
        success: function($prodotto) {
        alert("I dati sono stati correttamente salvati");
        console.log(data)
        },
        error: function(error) {
        alert("I dati non sono stati salvati, controlla e reinvia");
        console.log(error)
        }
        });
        });
  
</script>
{% endblock %}